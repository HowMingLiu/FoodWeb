import './polyfills.server.mjs';
import{f as V,g as $,h as j,i as z,n as B,p as H,z as R}from"./chunk-J4UXVLRS.mjs";import{$a as u,Ka as m,Ma as d,Oa as T,Pa as i,Qa as o,R as S,Ra as h,Sa as b,Ta as w,Ua as x,V as E,Xa as _,Ya as p,Za as N,_a as c,ab as M,ca as P,da as O,fb as F,hb as A,ib as D,jb as k,ta as y,wa as r,xa as I}from"./chunk-BZJLU45N.mjs";import"./chunk-VVCT4QZE.mjs";var J=e=>({active:e});function U(e,l){if(e&1&&(i(0,"span"),c(1),o()),e&2){let n=p();r(),u(n.cartTotalNumber)}}function q(e,l){if(e&1&&(i(0,"span",25),c(1),o()),e&2){let n=p(2).$implicit;r(),M("",100-n.discountOff*100,"% OFF")}}function G(e,l){if(e&1&&(i(0,"span",26),c(1),D(2,"number"),o()),e&2){let n=p(2).$implicit;r(),M("$",k(2,1,n.price*n.discountOff,"1.0-0"),"")}}function K(e,l){if(e&1){let n=x();i(0,"div",19),m(1,q,2,1,"span",20),h(2,"img",21),i(3,"h3"),c(4),o(),i(5,"p"),c(6),o(),i(7,"p"),c(8,"--------------"),o(),i(9,"span"),c(10),o(),m(11,G,3,4,"span",22),i(12,"div",23),_("click",function(){P(n);let g=p().$implicit,s=p(2);return O(s.addToCart(g))}),h(13,"img",24),i(14,"p"),c(15,"\u52A0\u5165\u8CFC\u7269\u8ECA"),o()()()}if(e&2){let n=p().$implicit;r(),d("ngIf",n.discountOff!=1),r(),N("src","/assets/images/orderPhoto/",n.photoSrc,"",y),r(2),u(n.title),r(2),u(n.engTitle),r(3),T(n.discountOff!=1?"del":""),r(),M("$",n.price,""),r(),d("ngIf",n.discountOff!=1)}}function L(e,l){if(e&1&&(b(0),m(1,K,16,10,"div",18),w()),e&2){let n=l.index,t=p(2);r(),d("ngIf",n>=(t.nowPage-1)*6&&n<t.nowPage*6)}}function Q(e,l){if(e&1&&(i(0,"div",16),m(1,L,2,1,"ng-container",17),o()),e&2){let n=p();r(),d("ngForOf",n.menuNow)}}function W(e,l){if(e&1){let n=x();i(0,"div")(1,"a",4),_("click",function(){let g=P(n).$implicit,s=p(3);return O(s.nowPageTo(g))}),c(2),o()()}if(e&2){let n=l.$implicit,t=p(3);r(),d("ngClass",A(2,J,n==t.nowPage)),r(),u(n)}}function X(e,l){if(e&1){let n=x();i(0,"nav")(1,"a",27),_("click",function(){P(n);let g=p(2);return O(g.prevPage())}),c(2,"Prev"),o(),m(3,W,3,4,"div",17),i(4,"a",27),_("click",function(){P(n);let g=p(2);return O(g.nextPage())}),c(5,"Next"),o()()}if(e&2){let n=p(2);r(3),d("ngForOf",n.pageNum)}}function Y(e,l){if(e&1&&(b(0),m(1,X,6,1,"nav",13),w()),e&2){let n=p();r(),d("ngIf",!n.openCart)}}function Z(e,l){if(e&1){let n=x();i(0,"tr")(1,"td"),c(2),o(),i(3,"td")(4,"button",27),_("click",function(){let g=P(n).index,s=p(2);return O(s.subCartNumber(g))}),c(5,"-"),o(),c(6),i(7,"button",27),_("click",function(){let g=P(n).index,s=p(2);return O(s.addCartNumber(g))}),c(8,"+"),o()(),i(9,"td"),c(10),D(11,"number"),o(),i(12,"td"),c(13),o()()}if(e&2){let n=l.$implicit;r(2),u(n.title),r(4),M(" ",n.count," "),r(4),u(k(11,4,n.price*n.discountOff,"1.0-0")),r(3),u(n.totalPrice)}}function tt(e,l){if(e&1&&(i(0,"table")(1,"thead")(2,"tr")(3,"th"),c(4,"\u54C1\u9805"),o(),i(5,"th"),c(6,"\u6578\u91CF"),o(),i(7,"th"),c(8,"\u55AE\u50F9"),o(),i(9,"th"),c(10,"\u7E3D\u50F9"),o()()(),i(11,"tbody"),m(12,Z,14,7,"tr",17),o(),i(13,"tfoot")(14,"tr"),h(15,"td")(16,"td"),i(17,"td"),c(18,"\u7E3D\u91D1\u984D"),o(),i(19,"td",28),c(20),o()()()()),e&2){let n=p();r(12),d("ngForOf",n.shoppingCartData),r(8),u(n.checkoutPrice)}}var st=(()=>{let l=class l{constructor(t){this.http=t,this.router=S(R),this.menuData=[],this.isDiscount=!0,this.pageNum=[],this.perPage=6,this.nowPage=1,this.menuFries=[],this.menuHamburger=[],this.menuNow=[],this.optionActive={all:"active",fries:"",hamburger:""},this.shoppingCartData=[],this.isEdit=!1,this.checkOutPrice=0,this.openCart=!1}ngOnInit(){this.http.get("/menu").subscribe(g=>{this.menuData=g.data,this.menuData.sort((a,C)=>{let f=Number(a.title.slice(6)),v=Number(C.title.slice(6));return f-v});let s=Math.ceil(this.menuData.length/this.perPage);for(let a=0;a<s;a++)this.pageNum.push(a+1);this.menuFries=this.menuData.filter(a=>a.title.includes("\u85AF\u689D")),this.menuHamburger=this.menuData.filter(a=>a.title.includes("\u6F22\u5821")),this.menuNow=this.menuData});let t="";if(localStorage.getItem("username")&&localStorage.getItem("password")){let g=`/menu/${localStorage.getItem("username")}&${localStorage.getItem("password")}`;this.http.get(g).subscribe(s=>{this.shoppingCartData=s.data})}else(localStorage.getItem("username")||localStorage.getItem("password"))&&this.router.navigate(["auth"])}nowPageTo(t){this.nowPage=t}prevPage(){this.nowPage>1&&this.nowPage--}nextPage(){this.nowPage<this.pageNum.length&&this.nowPage++}menuOption(t){switch(this.nowPage=1,t){case"all":this.menuNow=this.menuData,this.optionActive={all:"active",fries:"",hamburger:""};break;case"fries":this.menuNow=this.menuFries,this.optionActive={all:"",fries:"active",hamburger:""};break;case"hamburger":this.menuNow=this.menuHamburger,this.optionActive={all:"",fries:"",hamburger:"active"};break}}addToCart(t){if(!localStorage.getItem("username"))if(confirm("\u767B\u5165\u5F8C\u5373\u53EF\u64CD\u4F5C"))this.router.navigate(["auth"]);else return;this.isEdit=!0;let g={title:t.title,price:t.price,isDiscount:t.isDiscount,discountOff:t.discountOff,count:1,totalPrice:t.price};this.shoppingCartData.push(g);for(let a=0;a<this.shoppingCartData.length;a++)for(let C=0;C<this.shoppingCartData.length;C++)this.shoppingCartData[a].title==this.shoppingCartData[C].title&&a!=C&&this.shoppingCartData[a].count&&(this.shoppingCartData[a].count+=this.shoppingCartData[C].count,this.shoppingCartData[C].count=0);let s=this.shoppingCartData.filter(a=>a.count!=0);s.forEach(a=>{a.totalPrice=a.count*Math.floor(a.price*a.discountOff)}),s.sort((a,C)=>{let f=Number(a.title.slice(6)),v=Number(C.title.slice(6));return f-v}),this.shoppingCartData.length=0,this.shoppingCartData.push(...s)}subCartNumber(t){this.isEdit=!0,this.shoppingCartData[t].count--,this.shoppingCartData[t].count==0?this.shoppingCartData.splice(t,1):this.shoppingCartData[t].totalPrice=this.shoppingCartData[t].count*Math.floor(this.shoppingCartData[t].price*this.shoppingCartData[t].discountOff),this.shoppingCartData.length==0&&(console.log(123),this.openCart=!1)}addCartNumber(t){this.isEdit=!0,this.shoppingCartData[t].count<50&&(this.shoppingCartData[t].count++,this.shoppingCartData[t].totalPrice=this.shoppingCartData[t].count*Math.floor(this.shoppingCartData[t].price*this.shoppingCartData[t].discountOff))}openCartStatus(){if(this.cartTotalNumber&&(this.openCart=!this.openCart),this.isEdit){let t=`/menu/${localStorage.getItem("username")}&${localStorage.getItem("password")}/shoppingCart`;this.http.patch(t,JSON.stringify(this.shoppingCartData),{headers:{"Content-Type":"application/json"}}).subscribe(),this.isEdit=!1}}get checkoutPrice(){return this.shoppingCartData.reduce((t,g)=>t+g.totalPrice,0)}get cartTotalNumber(){return this.shoppingCartData.reduce((t,g)=>t+g.count,0)}};l.\u0275fac=function(g){return new(g||l)(I(B))},l.\u0275cmp=E({type:l,selectors:[["app-order-page"]],standalone:!0,features:[F],decls:28,vars:7,consts:[[1,"cartDesktop"],[1,"option"],[1,"title"],["src","/assets/images/hamburger.svg"],[3,"click","ngClass"],[1,"sectionCard"],[1,"top"],[1,"search"],["type","text","id","filterInput","placeholder","\u641C\u5C0B"],["for","filterInput"],["src","/assets/images/search-alt.svg"],[1,"shoppingCart",3,"click"],["src","/assets/images/shopping-cart.svg"],[4,"ngIf"],[1,"content"],["class","card",4,"ngIf"],[1,"card"],[4,"ngFor","ngForOf"],["class","perCard",4,"ngIf"],[1,"perCard"],["class","discountTag",4,"ngIf"],[3,"src"],["class","discountPrice",4,"ngIf"],[1,"car",3,"click"],["src","/assets/images/shopping-cart2.svg"],[1,"discountTag"],[1,"discountPrice"],[3,"click"],[1,"total"]],template:function(g,s){g&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),h(3,"img",3),i(4,"h3"),c(5,"\u7DDA\u4E0A\u8A02\u8CFC\u7F8E\u98DF"),o()(),i(6,"ul")(7,"li",4),_("click",function(){return s.menuOption("all")}),c(8,"\u5168\u90E8"),o(),i(9,"li",4),_("click",function(){return s.menuOption("fries")}),c(10,"\u53EA\u611B\u5403\u85AF\u689D"),o(),i(11,"li",4),_("click",function(){return s.menuOption("hamburger")}),c(12,"\u4E0D\u6557\u6F22\u5821\u7CFB\u5217"),o()()(),i(13,"div",5)(14,"div",6)(15,"div",7),h(16,"input",8),i(17,"label",9),h(18,"img",10),o()(),i(19,"div",11),_("click",function(){return s.openCartStatus()}),i(20,"p"),c(21,"\u8CFC\u7269\u8ECA"),o(),h(22,"img",12),m(23,U,2,1,"span",13),o()(),i(24,"div",14),m(25,Q,2,1,"div",15)(26,Y,2,1,"ng-container",13)(27,tt,21,2,"table",13),o()()()),g&2&&(r(7),d("ngClass",s.optionActive.all),r(2),d("ngClass",s.optionActive.fries),r(2),d("ngClass",s.optionActive.hamburger),r(12),d("ngIf",s.cartTotalNumber),r(2),d("ngIf",!s.openCart),r(),d("ngIf",s.menuNow.length>6),r(),d("ngIf",s.openCart))},dependencies:[H,$,j,z,V],styles:[".cartDesktop[_ngcontent-%COMP%]{display:flex;padding:30px;background-color:#faeae5}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{width:20%}@media (max-width:768px){.cartDesktop[_ngcontent-%COMP%]{flex-direction:column;padding:0}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{width:auto;text-align:center;margin:0 auto}}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:10px}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:24px}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#3d1101}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid black;color:#3d1101;cursor:pointer}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{font-weight:700;text-shadow:2px 2px 4px #661f05}.cartDesktop[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#3d1101;color:#fff}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:20px}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:60%;display:flex;justify-content:center;align-items:center}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:90%;height:30px;z-index:1;border:2px solid #3D1101;border-radius:5px}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{z-index:2;margin-left:-3px;margin-top:2.5px}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;background-color:#3d1101;border-radius:0 5px 5px 0}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .shoppingCart[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:relative;cursor:pointer}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .shoppingCart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#3d1101;padding-right:10px;margin-right:10px;border-right:2px solid #3d1101;display:inline-block}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .shoppingCart[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}@keyframes _ngcontent-%COMP%_test{50%{transform:scale(1.3)}to{transform:scale(1)}}.sectionCard[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .shoppingCart[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:20px;height:20px;background-color:orange;line-height:20px;color:#fff;text-align:center;border-radius:10px;position:absolute;right:-10px;top:-10px}.cartDesktop[_ngcontent-%COMP%]   .sectionCard[_ngcontent-%COMP%]{width:80%}@media (max-width:768px){.cartDesktop[_ngcontent-%COMP%]   .sectionCard[_ngcontent-%COMP%]{width:auto}}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:0 auto;display:flex;justify-content:center;align-items:center;flex-direction:column}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{margin:20px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;text-align:center;color:#3d1101;border:1px solid #661f05;border-radius:5px;text-decoration:none;padding:5px;margin:0 5px;cursor:pointer}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#3d1101;color:#fff}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .perCard[_ngcontent-%COMP%]{width:31.3333%;margin:1%;box-shadow:1px 1px 2px #5a5252;border-radius:10px;text-align:center;position:relative;overflow:hidden;transition:.1s linear all;height:285px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .perCard[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 0 10px #000;cursor:pointer}@media (max-width:768px){.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .perCard[_ngcontent-%COMP%]{width:48%;margin:1%}}@media (max-width:375px){.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .perCard[_ngcontent-%COMP%]{width:98%;margin:1%}}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .discountTag[_ngcontent-%COMP%]{position:absolute;right:-40px;top:5px;margin:0;font-size:12px;background-color:#c80a0a;border:1px solid yellow;transform:rotate(25deg);color:#fff;font-weight:700;width:130px;height:18px;line-height:19px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px;margin:10px 0 5px;color:#3d1101}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;margin:20px 0;display:inline-block}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .del[_ngcontent-%COMP%]{font-size:20px;margin:20px 0;text-decoration-line:line-through;-webkit-text-decoration-line:line-through;text-decoration-color:red;-webkit-text-decoration-color:red}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .discountPrice[_ngcontent-%COMP%]{font-size:24px;margin:20px 0;font-weight:700}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .car[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;border:3px solid orange;border-radius:10px;margin:10px;transition:.2s linear all}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .car[_ngcontent-%COMP%]:active{transform:scale(1.05)}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .car[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:10px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .car[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:orange;font-weight:700}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:500px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-top:1px solid #3d1101}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;font-weight:700;color:#3d1101;padding:2px 0}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){width:150px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){width:150px}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#3d1101}@media (max-width:768px){.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px}}.sectionCard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:0;padding-inline:0;font-size:24px;padding:5px;width:24px;cursor:pointer}"]});let e=l;return e})();export{st as OrderPageComponent};
